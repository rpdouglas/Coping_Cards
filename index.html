<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <!-- UPDATED: Title for the application -->
  <title>The Addicts Agenda</title>
  <link rel="manifest" href="manifest.json">
  <style>
    :root {
      --bg: #f7f7f9;
      --card-radius: 16px;
      --font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      --color-blue: #2b77f0;
      --color-shadow: rgba(43, 119, 240, 0.3);
    }
    html,body{height:100%;margin:0;font-family:var(--font-family);background:linear-gradient(180deg,#f4f7fb,#ffffff);display:flex;align-items:center;justify-content:center}
    .app{width:100%;max-width:720px;padding:24px;box-sizing:border-box}
    .hero{background:#ffffff;padding:28px;border-radius:18px;box-shadow:0 6px 18px rgba(32,40,60,0.08);text-align:center}
    h1{margin:0;font-size:28px}
    p.sub{color:#556;opacity:0.8;margin-top:8px}

    /* Primary Blue Button Style */
    button.primary{margin-top:20px;padding:14px 20px;border-radius:12px;border:0;background:var(--color-blue);color:#fff;font-size:18px;font-weight:600;width:100%;box-shadow:0 6px 16px var(--color-shadow);cursor:pointer;transition:background 0.2s}
    button.primary:hover{background:#2361c4}

    /* Secondary/Action Buttons */
    button{cursor:pointer;background:none;border:none;color:var(--color-blue);font-size:16px;padding:8px;font-weight:500}
    /* ADDED FOR ACCESSIBILITY */
    button:focus-visible {
      outline: 2px solid var(--color-blue);
      outline-offset: 2px;
    }

    /* Fact Box Styling */
    .fact-box {
        margin-top: 30px;
        padding: 20px;
        background: #f0f7ff;
        border: 1px solid #d0e4ff;
        border-radius: 12px;
        text-align: center;
    }
    .fact-box h2 {
        font-size: 16px;
        font-weight: 700;
        color: var(--color-blue);
        margin-top: 0;
        margin-bottom: 10px;
    }
    .fact-box p {
        font-size: 16px;
        color: #444;
        margin: 0;
        font-style: italic;
    }

    .card-area{min-height:360px;background:#fff;border-radius:var(--card-radius);padding:40px 24px 24px;display:flex;flex-direction:column;align-items:center;justify-content:space-between;box-shadow:0 6px 18px rgba(32,40,60,0.08);text-align:center; transition: background 0.5s ease;}
    
    /* UPDATED: Card text colors set to white for contrast against dark gradients */
    #cardIcon{font-size:80px;line-height:1;margin-bottom:12px; color: #fff;}
    #cardSuit{font-size:24px;font-weight:600;text-transform:uppercase;color:#fff}
    #cardText{font-size:24px;font-weight:500;margin:20px 0 40px;padding:0 20px;color:#fff}
    
    .actions button{margin:0 10px}
    .status-text{font-size:14px;color:#777;margin-top:10px}
  </style>
</head>
<body>
  <div class="app">

    <!-- NEW HOME SCREEN -->
    <div id="homeScreen" style="display:block;">
        <div class="hero">
            <h1>The Addicts Agenda</h1>
            <p class="sub">Find inspiration and practical tools for your recovery journey.</p>
            
            <div class="fact-box">
                <h2>Recovery Fact of the Day</h2>
                <p id="dailyFactText">Loading daily inspiration...</p>
            </div>

            <!-- Button to Coping Cards (Card Intro Screen) -->
            <button id="goToCardsBtn" class="primary">Go to Coping Cards</button>
        </div>
    </div>
    
    <!-- CARD INTRO SCREEN (Original Home Screen) -->
    <div id="cardIntro" style="display:none;">
      <div class="hero">
        <h1>52 Coping Cards</h1>
        <p class="sub">Need a quick strategy to manage a craving? Draw a card.</p>
        <button id="drawBtn" class="primary">Draw a Card</button>
      </div>
    </div>
    
    <!-- CARD VIEW SCREEN -->
    <div id="cardView" style="display:none;">
      <div id="cardArea" class="card-area">
        <div>
          <span id="cardIcon"></span>
          <div id="cardSuit"></div>
        </div>
        <p id="cardText"></p>
        <div class="actions">
          <button id="nextBtn">Next Card</button>
          <button id="shuffleBtn">Shuffle Deck</button>
          <!-- Changed Reset to go back to the main homepage -->
          <button id="resetBtn">Home</button>
        </div>
        <div id="statusText" class="status-text"></div>
      </div>
    </div>
  </div>
  
  <script>
    const cards = [
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Tense and then relax your muscles. Repeat 3 times.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Do 10 jumping jacks or jog in place for 30 seconds.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Stretch your entire body for 60 seconds.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Go for a walk, even if it is just a lap around the house.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Take 5 deep breaths, focusing only on the air moving in and out.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Clean an area of your home for 5 minutes (e.g., wash a few dishes).'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Do a quick chore like taking out the trash or folding one piece of laundry.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Drink a full glass of water or a soothing hot beverage.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Splash cold water on your face.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Change your location. Move to another room or step outside.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Do a 2-minute wall sit or plank.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Hold ice in your hand for a minute until the feeling subsides.'},
      {suit: 'Action & Movement', suit_key: 'blue', icon: 'ðŸƒâ€â™‚ï¸', text: 'Eat a small, healthy snack, like a piece of fruit.'},
      
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Use a grounding technique. Name 5 things you see, 4 you touch, 3 you hear, 2 you smell, 1 you taste.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Write down three things you are grateful for right now.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Picture a favorite memory, like a vacation or a celebration. Focus on the details.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Say a positive affirmation out loud 10 times.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Watch a funny video or read a lighthearted article.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Try to recall the lyrics to your favorite song, word for word.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Look at a complex image or pattern and try to find a repeating element.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Do a quick Sudoku or word search puzzle.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Listen to a guided meditation for 5 minutes.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Imagine the feeling of the craving passing and how good it will feel.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Read a book or news article for 5 minutes.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Do a body scan. Focus on each part of your body from head to toe.'},
      {suit: 'Mind & Focus', suit_key: 'green', icon: 'ðŸ§ ', text: 'Mentally list all the cities or states you can remember.'},

      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Call or text a supportive friend or family member.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Check in with your sponsor or accountability partner.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Send a quick encouraging text to someone else in recovery.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Write down a commitment you can share with a friend later.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Read a few passages from an inspirational book or literature.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Go online to find a quick, virtual support meeting.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Write a quick email or note to thank someone in your life.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Say your name and what you are feeling right now out loud to an empty room.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Think about who in your life you could help with something small today.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Reach out to a professional (therapist, doctor) for advice if the craving persists.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Talk to a pet or plant for 5 minutes.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Offer a genuine compliment to a stranger or person nearby.'},
      {suit: 'Connection & Support', suit_key: 'orange', icon: 'ðŸ’¬', text: 'Read through old notes or cards from loved ones.'},

      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Write a short story or poem about your current feeling.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Listen to a piece of classical music youâ€™ve never heard before.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Draw or doodle for 5 minutes without judging the result.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Watch a short documentary or educational video on a random topic.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Pick up a new musical instrument (even a simple one like a harmonica) and try it.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Look up a recipe and plan to make it later this week.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Browse an online museum or art gallery.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Start a journal entry about your goals for the next month.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Learn a few words in a new language using an app or website.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Write down the ABCs backwards.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Look up the definition of a word you donâ€™t know and use it in a sentence.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Do something tactile, like playing with modeling clay or sand.'},
      {suit: 'Creative & Learning', suit_key: 'purple', icon: 'ðŸŽ¨', text: 'Try to balance an object on your finger for 60 seconds.'}
    ];

    // Array of Pop Culture Recovery Facts
    const POP_FACTS = [
        "In his recovery, actor Robert Downey Jr. pursued martial arts and therapy, stating: 'Job one is get out of that cave.'",
        "Actress Jamie Lee Curtis became addicted to prescription painkillers after a cosmetic surgery but has been sober since 1999, crediting her sobriety with giving her everything of value in her life.",
        "Bradley Cooper, who has been sober since 2004, credits his sobriety with saving his career and allowing him to become an A-list actor.",
        "Musician Elton John, who entered recovery in 1990, established the Elton John AIDS Foundation two years later, using his energy to help others.",
        "Actor Daniel Radcliffe sought sobriety in 2010 to cope with anxiety and stress after the Harry Potter series wrapped up, finding greater peace without alcohol.",
        "After battling substance abuse in her youth, Drew Barrymore went to rehab at age 13 and is now a successful actress and talk show host, openly sharing her journey.",
        "Actor Danny Trejo has been sober for over 50 years, having gotten clean well before his career took off.",
        "Samuel L. Jackson got sober in the early 1990s, realizing his acting career would require it, and has since become one of Hollywood's most successful actors.",
    ];

    let deck = [...cards]; // Full set of cards, initially available

    // --- Helper Functions ---
    // UPDATED: Function now returns a bold, two-color linear gradient string
    function suitColor(suit_key){
      switch(suit_key){
        case 'blue': return 'linear-gradient(135deg, #5B86E5 0%, #36D1DC 100%)'; // Action & Movement
        case 'green': return 'linear-gradient(135deg, #2ECC71 0%, #56C87C 100%)'; // Mind & Focus
        case 'orange': return 'linear-gradient(135deg, #F5B041 0%, #F8D383 100%)'; // Connection & Support
        case 'purple': return 'linear-gradient(135deg, #A569BD 0%, #D2B4DE 100%)'; // Creative & Learning
        default: return '#fff';
      }
    }

    function updateStatus(){
      document.getElementById('statusText').textContent = `Cards left in deck: ${deck.length} / 52`;
    }

    function renderCard(c){
      document.getElementById('cardIcon').textContent = c.icon;
      document.getElementById('cardSuit').textContent = c.suit;
      document.getElementById('cardText').textContent = c.text;
      // Set background using the new gradient
      document.getElementById('cardArea').style.background = suitColor(c.suit_key);
      updateStatus();
    }

    function drawRandom(){
      if(deck.length === 0) return null;
      const idx = Math.floor(Math.random()*deck.length);
      const card = deck.splice(idx,1)[0];
      return card;
    }
    
    function displayAppView(viewId) {
        document.getElementById('homeScreen').style.display = 'none';
        document.getElementById('cardIntro').style.display = 'none';
        document.getElementById('cardView').style.display = 'none';
        document.getElementById(viewId).style.display = 'block';
    }

    function getDailyFact() {
        // Use the day of the year to cycle through facts
        const today = new Date();
        const start = new Date(today.getFullYear(), 0, 0);
        const diff = today - start;
        const oneDay = 1000 * 60 * 60 * 24;
        const dayOfYear = Math.floor(diff / oneDay);
        
        const factIndex = dayOfYear % POP_FACTS.length;
        document.getElementById('dailyFactText').textContent = POP_FACTS[factIndex];
    }


    // --- Event Listeners ---
    // NEW: Go to Card Intro Screen from Home Screen
    document.getElementById('goToCardsBtn').addEventListener('click', ()=>{
      displayAppView('cardIntro');
    });
    
    // Original Draw Button: Start the game
    document.getElementById('drawBtn').addEventListener('click', ()=>{
      const card = drawRandom();
      if(!card) { 
        // Use a custom message style instead of alert()
        console.log('Deck empty â€” shuffle or reset.'); 
        // Note: In a real app, you'd use a custom modal for this message.
        alert('Deck empty â€” please shuffle or return home.'); 
        return;
      }
      renderCard(card);
      displayAppView('cardView');
    });

    document.getElementById('nextBtn').addEventListener('click', ()=>{
      const card = drawRandom();
      if(!card) {
        // Use a custom message style instead of alert()
        console.log('Deck empty â€” shuffle or reset.'); 
        // Note: In a real app, you'd use a custom modal for this message.
        alert('Deck empty â€” please shuffle or return home.'); 
        return;
      }
      renderCard(card);
    });

    document.getElementById('shuffleBtn').addEventListener('click', ()=>{
      deck = [...cards].sort(()=>Math.random()-0.5);
      updateStatus();
      // Use console log instead of alert
      console.log('Deck shuffled.');
    });

    // UPDATED: Reset button now goes to the main home screen
    document.getElementById('resetBtn').addEventListener('click', ()=>{
      deck = [...cards];
      displayAppView('homeScreen');
      updateStatus();
    });

    // --- Initialization ---
    function initializeApp() {
        getDailyFact();
        updateStatus();
        // Ensure the home screen is the default view on load
        displayAppView('homeScreen');
    }

    initializeApp();


    // Register Service Worker
    if('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(function(reg) {
          console.log('Service Worker Registered');
        })
        .catch(function(err) {
          console.log('Service Worker Registration Failed:', err);
        });
    }
  </script>
</body>
</html>
