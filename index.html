<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>The Addicts Agenda</title>
  <link rel="manifest" href="manifest.json">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div class="app">

    <!-- 1. HOME SCREEN -->
    <div id="homeScreen" style="display:block;">
        <div class="hero">
            <div id="appVersion">V0.12</div>
            <div class="settings-container">
                <button id="goToSettingsBtn" class="settings-cog" title="Settings">&#x2699;</button>
            </div>
            <h1>The Addicts Agenda</h1>
            <p class="sub">Find inspiration and practical tools for your recovery journey.</p>
            <p id="homeSobrietyDuration" style="color: var(--color-blue);">Set your sober date in Settings.</p>
            <div class="fact-box">
                <h2 id="dailyFactHeader">Recovery Fact of the Day</h2>
                <p id="dailyFactText">Loading daily inspiration...</p>
            </div>
            <button id="goToCardsBtn" class="primary">Draw a Coping Card</button>
            <button id="goToJournalBtn" class="primary" style="margin-top: 15px;">Start Journaling</button>
            <button id="goToTodoBtn" class="primary" style="margin-top: 15px;">View To Do List</button>
            <div class="reflection-group">
                <button id="goToReflectionBtn" class="primary">Daily Reflection (AA)</button>
                <button id="goToJFTBtn" class="primary">Just for Today (NA)</button>
            </div>
            <button id="goToLiteratureBtn" class="primary" style="margin-top: 15px;">Recovery Literature</button>
            <button id="goToWorkbooksBtn" class="primary" style="margin-top: 15px;">Recovery Workbooks</button>
        </div>
    </div>
    
    <!-- 2. CARD INTRO SCREEN (Unused) -->
    <div id="cardIntro" style="display:none;">
      <div class="hero">
        <h1>52 Coping Cards</h1>
        <p class="sub">Need a quick strategy to manage a craving? Draw a card.</p>
        <button id="drawBtn" class="primary">Draw a Card</button>
      </div>
    </div>
    
    <!-- 3. CARD VIEW SCREEN -->
    <div id="cardView" style="display:none;">
      <div id="cardArea" class="card-area">
        <div>
          <span id="cardIcon"></span>
          <div id="cardSuit"></div>
        </div>
        <p id="cardText"></p>
        <div class="actions">
          <button id="nextBtn" class="secondary">Next Card</button>
          <button id="resetBtn" class="secondary">Home</button>
        </div>
        <div id="statusText" class="status-text"></div>
      </div>
    </div>

    <!-- 4. JOURNAL VIEW SCREEN -->
    <div id="journalView" style="display:none;">
        <div class="content-card">
            <div id="journalList" style="display:none;">
                <h2>Journal Entries</h2>
                <div class="list-view-actions">
                    <button id="openListHomeBtn" class="secondary">Home</button>
                    <button id="newEntryBtn" class="secondary">Write Today's Entry</button>
                </div>
                <ul id="entryList" class="journal-entry-list"></ul>
            </div>
            <div id="promptManagerView" style="display:none;">
                <h2>Manage Custom Prompts</h2>
                <div class="prompt-row">
                    <input type="text" id="customPromptInput" placeholder="Enter new prompt text..." style="flex-grow: 1;">
                    <button id="addCustomPromptBtn" class="secondary">Add</button>
                </div>
                <p class="sub" style="text-align: center;">Click a prompt below to delete it.</p>
                <ul id="customPromptList" class="journal-entry-list prompt-list-manager"></ul>
                <div class="actions-row" style="justify-content: flex-end; margin-top: 20px;">
                    <button id="backToEntryBtn" class="secondary">Back to Journal</button>
                </div>
            </div>
            <div id="journalEntryView">
                <h2>Today's Reflection</h2>
                <p class="sub" style="text-align: center;">Use this space to process cravings, track progress, or reflect on your card.</p>
                <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 10px;">
                    <label for="entryDate">Date:</label>
                    <input type="date" id="entryDate">
                </div>
                <div class="prompt-row" style="margin-top: 15px;">
                    <select id="promptSelect"></select>
                    <button id="managePromptsBtn" class="secondary">Manage Prompts</button>
                </div>
                <textarea id="journalEntry" placeholder="What's on your mind today?"></textarea>
                <div class="actions-row">
                    <button id="viewAllEntriesBtn" class="secondary">View All Entries</button>
                    <div class="list-view-actions">
                        <button id="saveJournalBtn" class="secondary">Save Entry</button>
                        <button id="entryHomeBtn" class="secondary">Home</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- 5. SETTINGS VIEW SCREEN -->
    <div id="settingsView" style="display:none;">
        <div class="content-card">
            <h2>App Settings</h2>
            <div class="settings-group">
                <p class="sub" style="text-align: center; margin-bottom: 20px;">Track your journey.</p>
                <h3>Sober Date Tracking</h3>
                <label for="soberDateInput" style="display: block; margin-bottom: 8px; font-weight: 600;">Your Sober Date:</label>
                <input type="date" id="soberDateInput" style="width: 100%; margin-bottom: 20px;">
                <p id="sobrietyDuration" style="font-size: 1.1em; font-weight: bold; text-align: center; color: var(--color-blue); min-height: 20px;"></p>
            </div>
            <div class="actions-row" style="justify-content: flex-end; gap: 10px;">
                <button id="saveSettingsBtn" class="secondary">Save Date</button>
                <button id="settingsHomeBtn" class="secondary">Home</button>
            </div>
        </div>
    </div>
    
    <!-- 6. NEW TO DO LIST VIEW SCREEN -->
    <div id="todoView" style="display:none;">
        <div class="content-card">
            <h2>My To Do List</h2>
            <p class="sub" style="text-align: center;">Keep track of small, actionable tasks.</p>
            <div class="todo-input-group">
                <input type="text" id="todoInput" placeholder="Task description">
                <input type="date" id="todoDateInput">
                <select id="todoRecurrenceSelect">
                    <option value="none">No Repeat</option>
                    <option value="daily">Daily</option>
                    <option value="weekly">Weekly</option>
                    <option value="biweekly">Every 2 Weeks</option>
                    <option value="monthly">Monthly</option>
                    <option value="yearly">Yearly</option>
                </select>
                <button id="addTodoBtn" class="secondary">Add Task</button>
            </div>
            <ul id="todoList" class="todo-list"></ul>
            <div class="actions-row" style="justify-content: flex-end; gap: 10px;">
                <button id="todoHomeBtn" class="secondary">Home</button>
            </div>
        </div>
    </div>

    <!-- 7. NEW RECOVERY LITERATURE VIEW SCREEN -->
    <div id="literatureView" style="display:none;">
        <div class="content-card">
            <h2>Recovery Literature: Big Book Excerpts</h2>
            <p class="sub" style="text-align: center;">Read key foundational texts from the fellowship.</p>
            <div id="literatureContent">
                <div class="literature-chapter">
                    <h3>Chapter 1: Bill's Story</h3>
                    <p>Bill W.'s story is the compelling and historic account of how the co-founder of Alcoholics Anonymous discovered his powerlessness over alcohol and, through a spiritual experience and connection with others, found a way out. It details his struggles in the business world, his devastating descent into alcoholism, his institutionalization, and the transformative visit from his old friend, Ebby T. His realization that only a spiritual experience and helping others could provide lasting sobriety became the bedrock of the entire program.</p>
                </div>
                <div class="literature-chapter">
                    <h3>Chapter 2: There is a Solution</h3>
                    <p>This chapter provides hope by asserting that recovery from alcoholism is possible. It emphasizes the importance of the fellowship (the "hundreds of men and women" who have recovered) and the fact that the solution lies not just in stopping drinking, but in a spiritual program of action. It introduces the core concept that alcoholism is a threefold disease—physical, mental, and spiritual—and that the spiritual malady requires a spiritual remedy, a practical method for living soberly.</p>
                </div>
            </div>
            <p class="literature-link">
                For the complete text, download the 
                <a href="https://aa-netherlands.org/for-members/big-book-online/" target="_blank" style="color: var(--color-blue); font-weight: 600;">Big Book Online (PDF)</a>.
            </p>
            <div class="actions-row" style="justify-content: flex-end; gap: 10px; margin-top: 40px;">
                <button id="literatureHomeBtn" class="secondary">Home</button>
            </div>
        </div>
    </div>

    <!-- 8. NEW RECOVERY WORKBOOKS VIEW SCREEN -->
    <div id="workbooksView" style="display:none;">
        <div class="content-card">
            <h2>Recovery Workbooks</h2>
            <p class="sub" style="text-align: center;">Tools and step work resources.</p>
            <button id="goToStep1Btn" class="primary" style="margin-top: 15px;">Step 1: Powerlessness & Unmanageability</button>
            <button id="goToStep2Btn" class="primary" style="margin-top: 15px;">Step 2: Coming to Believe</button>
            <button id="goToStep3Btn" class="primary" style="margin-top: 15px;">Step 3: Turning It Over</button>
            <button id="goToStep4Btn" class="primary" style="margin-top: 15px;">Step 4: Moral Inventory</button>
            <!-- NEW: Button for Step 5 -->
            <button id="goToStep5Btn" class="primary" style="margin-top: 15px;">Step 5: Admitted Wrongs</button>
            <div class="actions-row" style="justify-content: flex-end; gap: 10px; margin-top: 40px;">
                <button id="workbooksHomeBtn" class="secondary">Home</button>
            </div>
        </div>
    </div>
    
    <!-- 9. NEW STEP ONE WORKBOOK VIEW SCREEN -->
    <div id="stepOneView" style="display:none;">
        <div class="content-card">
            <h2>Step 1: Admitted Powerlessness</h2>
            <p class="sub" style="text-align: center;">"We admitted we were powerless over cocaine and all other mind-altering substances—that our lives had become unmanageable."</p>
            <div id="stepOneQuestions"></div>
            <div class="actions-row">
                <p id="stepOneSaveStatus" style="color: green; font-weight: 600;"></p>
                <div class="list-view-actions">
                    <button id="saveStepOneBtn" class="secondary">Save Progress</button>
                    <button id="stepOneWorkbooksBtn" class="secondary">Workbooks Home</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 10. NEW STEP TWO WORKBOOK VIEW SCREEN -->
    <div id="stepTwoView" style="display:none;">
        <div class="content-card">
            <h2>Step 2: Coming to Believe</h2>
            <p class="sub" style="text-align: center;">"We came to believe that a Power greater than ourselves could restore us to sanity."</p>
            <div id="stepTwoQuestions"></div>
            <div class="actions-row">
                <p id="stepTwoSaveStatus" style="color: green; font-weight: 600;"></p>
                <div class="list-view-actions">
                    <button id="saveStepTwoBtn" class="secondary">Save Progress</button>
                    <button id="stepTwoWorkbooksBtn" class="secondary">Workbooks Home</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 11. NEW STEP THREE WORKBOOK VIEW SCREEN -->
    <div id="stepThreeView" style="display:none;">
        <div class="content-card">
            <h2>Step 3: Turning It Over</h2>
            <p class="sub" style="text-align: center;">"We made a decision to turn our will and our lives over to the care of God as we understood Him."</p>
            <div id="stepThreeQuestions"></div>
            <div class="actions-row">
                <p id="stepThreeSaveStatus" style="color: green; font-weight: 600;"></p>
                <div class="list-view-actions">
                    <button id="saveStepThreeBtn" class="secondary">Save Progress</button>
                    <button id="stepThreeWorkbooksBtn" class="secondary">Workbooks Home</button>
                </div>
            </div>
        </div>
    </div>
    
    <!-- 12. NEW STEP FOUR WORKBOOK VIEW SCREEN -->
    <div id="stepFourView" style="display:none;">
        <div class="content-card">
            <h2>Step 4: Moral Inventory</h2>
            <p class="sub" style="text-align: center;">"Made a searching and fearless moral inventory of ourselves."</p>
            <div id="stepFourQuestions"></div>
            <div class="actions-row">
                <p id="stepFourSaveStatus" style="color: green; font-weight: 600;"></p>
                <div class="list-view-actions">
                    <button id="saveStepFourBtn" class="secondary">Save Progress</button>
                    <button id="stepFourWorkbooksBtn" class="secondary">Workbooks Home</button>
                </div>
            </div>
        </div>
    </div>

    <!-- NEW: Step Five Workbook View Screen -->
    <div id="stepFiveView" style="display:none;">
        <div class="content-card">
            <h2>Step 5: Admitted Wrongs</h2>
            <p class="sub" style="text-align: center;">"Admitted to God, to ourselves, and to another human being the exact nature of our wrongs."</p>
            <div id="stepFiveQuestions"></div>
            <div class="actions-row">
                <p id="stepFiveSaveStatus" style="color: green; font-weight: 600;"></p>
                <div class="list-view-actions">
                    <button id="saveStepFiveBtn" class="secondary">Save Progress</button>
                    <button id="stepFiveWorkbooksBtn" class="secondary">Workbooks Home</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 13. NEW DAILY REFLECTION VIEW SCREEN -->
    <div id="reflectionView" style="display:none;">
        <div class="content-card">
            <h2>Daily Reflection (AA)</h2>
            <p class="sub" style="text-align: center;">A daily quote and meditation to guide your thoughts.</p>
            <label for="reflectionDateInput" style="display: block; text-align: center; font-weight: 600; margin-top: 10px;">Select Date:</label>
            <input type="date" id="reflectionDateInput">
            <div id="reflectionContent">
                <div class="loading-spinner" id="reflectionSpinner"></div>
                <p id="reflectionQuote" style="display: none;"></p>
                <p id="reflectionReading" style="display: none;"></p>
            </div>
            <div class="actions-row" style="justify-content: flex-end; gap: 10px; margin-top: 40px;">
                <button id="reflectionHomeBtn" class="secondary">Home</button>
            </div>
        </div>
    </div>
    
    <!-- 14. NEW JUST FOR TODAY VIEW SCREEN -->
    <div id="jftView" style="display:none;">
        <div class="content-card">
            <h2>Just for Today (NA)</h2>
            <p class="sub" style="text-align: center;">The daily spiritual message from Narcotics Anonymous.</p>
            <label for="jftDateInput" style="display: block; text-align: center; font-weight: 600; margin-top: 10px;">Select Date:</label>
            <input type="date" id="jftDateInput">
            <div id="jftContent" style="min-height: 250px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 15px; background: #f7f7f9; border-radius: 10px; border: 1px solid #ddd; margin-top: 15px;">
                <div class="loading-spinner" id="jftSpinner"></div>
                <p id="jftQuote" style="display: none; font-size: 1.2em; font-style: italic; color: #333; margin-bottom: 15px;"></p>
                <p id="jftReading" style="display: none; color: #555; line-height: 1.6;"></p>
            </div>
            <div class="actions-row" style="justify-content: flex-end; gap: 10px; margin-top: 40px;">
                <button id="jftHomeBtn" class="secondary">Home</button>
            </div>
        </div>
    </div>
  </div>
  
  <script type="module">
    import { App } from './global_events.js'; 
    App.initializeApp();
    if('serviceWorker' in navigator) {
      navigator.serviceWorker.register('sw.js')
        .then(reg => console.log('Service Worker Registered'))
        .catch(err => console.log('Service Worker Registration Failed:', err));
    }
  </script>
</body>
</html>


